ALTER TABLE `par_indicador_general` ADD `numerador` INT NULL DEFAULT NULL AFTER `descripcion`;
ALTER TABLE `par_indicador_general` ADD `denominador` INT NULL DEFAULT NULL AFTER `numerador`;

ALTER TABLE `par_indicador_general` ADD `numerador` TEXT NULL DEFAULT NULL AFTER `descripcion`, ADD `denominador` TEXT NULL DEFAULT NULL AFTER `numerador`;

ALTER TABLE `par_indicador_general` CHANGE `codigo` `codigo` VARCHAR(20) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL;

ALTER TABLE `par_indicador_general_meta` ADD `distrito` INT NULL DEFAULT NULL AFTER `periodo`;
ALTER TABLE `par_indicador_general_meta` ADD `anio_base` INT(4) NOT NULL AFTER `distrito`, ADD `valor_base` VARCHAR(15)  NOT NULL AFTER `anio_base`;

ALTER TABLE `par_indicador_general` CHANGE `numerador` `numerador` TEXT NULL DEFAULT NULL, CHANGE `denominador` `denominador` TEXT NULL DEFAULT NULL;


# inicio procedimiento almacenado

CREATE DEFINER=`root`@`localhost` PROCEDURE `datay`.`edu_pa_procesarImporMatriculaGeneral`(v_importacion_id INT, v_matriculageneral_id INT)
BEGIN

	UPDATE edu_impor_matricula_general SET
		id_anio=ltrim(rtrim(ifnull(id_anio,''))),
		cod_mod=ltrim(rtrim(ifnull(cod_mod,''))),
		modalidad=ltrim(rtrim(ifnull(modalidad,''))),
		id_nivel=ltrim(rtrim(ifnull(id_nivel,''))),
		id_gestion=ltrim(rtrim(ifnull(id_gestion,''))),
		pais_nacimiento=ltrim(rtrim(ifnull(pais_nacimiento,''))),
		fecha_nacimiento=ltrim(rtrim(ifnull(fecha_nacimiento,''))),
		sexo=ltrim(rtrim(ifnull(sexo,''))),
		lengua_materna=ltrim(rtrim(ifnull(lengua_materna,''))),
		segunda_lengua=ltrim(rtrim(ifnull(segunda_lengua,''))),
		di_leve=ltrim(rtrim(ifnull(di_leve,''))),
		di_moderada=ltrim(rtrim(ifnull(di_moderada,''))),
		di_severo=ltrim(rtrim(ifnull(di_severo,''))),
		discapacidad_fisica=ltrim(rtrim(ifnull(discapacidad_fisica,''))),
		trastorno_espectro_autista=ltrim(rtrim(ifnull(trastorno_espectro_autista,''))),
		dv_baja_vision=ltrim(rtrim(ifnull(dv_baja_vision,''))),
		dv_ceguera=ltrim(rtrim(ifnull(dv_ceguera,''))),
		da_hipoacusia=ltrim(rtrim(ifnull(da_hipoacusia,''))),
		da_sordera=ltrim(rtrim(ifnull(da_sordera,''))),
		sordoceguera=ltrim(rtrim(ifnull(sordoceguera,''))),
		otra_discapacidad=ltrim(rtrim(ifnull(otra_discapacidad,''))),
		situacion_matricula=ltrim(rtrim(ifnull(situacion_matricula,''))),
		estado_matricula=ltrim(rtrim(ifnull(estado_matricula,''))),
		fecha_matricula=ltrim(rtrim(ifnull(fecha_matricula,''))),
		id_grado=ltrim(rtrim(ifnull(id_grado,''))),
		dsc_grado=ltrim(rtrim(ifnull(dsc_grado,''))),
		id_seccion=ltrim(rtrim(ifnull(id_seccion,''))),
		dsc_seccion=ltrim(rtrim(ifnull(dsc_seccion,''))),
		fecha_registro=ltrim(rtrim(ifnull(fecha_registro,''))),
		fecha_retiro=ltrim(rtrim(ifnull(fecha_retiro,''))),
		motivo_retiro=ltrim(rtrim(ifnull(motivo_retiro,''))),
		sf_regular=ltrim(rtrim(ifnull(sf_regular,''))),
		sf_promocion_guiada=ltrim(rtrim(ifnull(sf_promocion_guiada,'')))
	WHERE importacion_id=v_importacion_id;



    BEGIN
		INSERT INTO edu_matricula_general_detalle(
		matriculageneral_id,	institucioneducativa_id, 	cod_mod, 				modalidad, 					nivel,
		gestion, 				pais_nacimiento, 			fecha_nacimiento, 		edad, 						sexo,
        lengua_materna, 		segunda_lengua, 			situacion_matricula, 	estado_matricula, 			fecha_matricula,
        id_grado, 				dsc_grado, 					id_seccion, 			dsc_seccion, 				fecha_registro,
        fecha_retiro, 			motivo_retiro, 				sf_regular, 			sf_promocion_guiada,		di_leve,
        di_moderada, 			di_severo, 					discapacidad_fisica, 	trastorno_espectro_autista, dv_baja_vision,
        dv_ceguera, 			da_hipoacusia, 				da_sordera, 			sordoceguera, 				otra_discapacidad
        )
		SELECT
			v_matriculageneral_id,
			(select id from edu_institucioneducativa  where codModular=imp.cod_mod),
			imp.cod_mod,
            imp.modalidad,
            (select id from edu_nivelmodalidad where codigo=imp.id_nivel ),

            (select id from edu_tipogestion where codigo=imp.id_gestion ),
			imp.pais_nacimiento,
			if(imp.fecha_nacimiento='NULL' or imp.fecha_nacimiento='',null,str_to_date(imp.fecha_nacimiento,'%Y-%m-%d')),
            YEAR(CURDATE())-YEAR(str_to_date(fecha_nacimiento,'%Y-%m-%d')) + IF(DATE_FORMAT(CURDATE(),'%m-%d') > DATE_FORMAT(str_to_date(fecha_nacimiento,'%Y-%m-%d'),'%m-%d'), 0 , -1 ),
			imp.sexo,

			imp.lengua_materna,
			imp.segunda_lengua,
			imp.situacion_matricula,
			imp.estado_matricula,
			if(imp.fecha_matricula='NULL' or imp.fecha_matricula='',null,str_to_date(imp.fecha_matricula,'%Y-%m-%d')),

			imp.id_grado,
			imp.dsc_grado,
			imp.id_seccion,
			imp.dsc_seccion,
			if(imp.fecha_registro='NULL' or imp.fecha_registro='',null,str_to_date(imp.fecha_registro,'%Y-%m-%d')),

			if(imp.fecha_retiro='NULL' or imp.fecha_retiro='',null,str_to_date(imp.fecha_retiro,'%Y-%m-%d')),
			imp.motivo_retiro,
			imp.sf_regular,
			imp.sf_promocion_guiada,
			if(imp.di_leve='NULL' or di_leve='',null,di_leve),

			if(imp.di_moderada='NULL' or di_moderada='',null,di_moderada),
			if(imp.di_severo='NULL' or di_severo='',null,di_severo),
			if(imp.discapacidad_fisica='NULL' or discapacidad_fisica='',null,discapacidad_fisica),
			if(imp.trastorno_espectro_autista='NULL' or trastorno_espectro_autista='',null,trastorno_espectro_autista),
			if(imp.dv_baja_vision='NULL' or dv_baja_vision='',null,dv_baja_vision),

			if(imp.dv_ceguera='NULL' or dv_ceguera='',null,dv_ceguera),
			if(imp.da_hipoacusia='NULL' or da_hipoacusia='',null,da_hipoacusia),
			if(imp.da_sordera='NULL' or da_sordera='',null,da_sordera),
			if(imp.sordoceguera='NULL' or sordoceguera='',null,sordoceguera),
			if(imp.otra_discapacidad='NULL' or otra_discapacidad='',null,otra_discapacidad)

		FROM edu_impor_matricula_general as imp WHERE imp.importacion_id=v_importacion_id;

		update par_importacion  set estado = 'PR' where id = v_importacion_id;

		truncate edu_impor_matricula_general;


    END;


END
# fin


# query para crear tabla padron actas

CREATE TABLE `sal_impor_padron_actas` (
  `id` int(11) NOT NULL,
  `importacion_id` int(11) DEFAULT NULL,
   nombre_municipio	varchar(40) DEFAULT NULL,
			departamento	varchar(10) DEFAULT NULL,
			provincia	varchar(30) DEFAULT NULL,
			distrito	varchar(50) DEFAULT NULL,
			fecha_inicial	varchar(10) DEFAULT NULL,
			fecha_final	varchar(10) DEFAULT NULL,
			fecha_envio	varchar(10) DEFAULT NULL,
			dni_usuario_envio	varchar(8) DEFAULT NULL,
			primer_apellido	varchar(20) DEFAULT NULL,
			segundo_apellido	varchar(20) DEFAULT NULL,
			prenombres	varchar(30) DEFAULT NULL,
			numero_archivos	int(11) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

ALTER TABLE `sal_impor_padron_actas` ADD PRIMARY KEY(`id`);
ALTER TABLE `sal_impor_padron_actas` CHANGE `id` `id` INT(11) NOT NULL AUTO_INCREMENT;
ALTER TABLE `sal_impor_padron_actas` ADD INDEX(`importacion_id`);

ALTER TABLE `sal_impor_padron_actas` CHANGE `dni_usuario_envio` `dni_usuario_envio` VARCHAR(12) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL;


########################################################

#query para modifcar table fuenteimportacion
########################################################


#

CREATE TABLE `sal_data_pacto1` (
  `id` int(11) NOT NULL,
  `importacion_id` int(11) DEFAULT NULL,
  `anio` int(11) DEFAULT NULL,
  `distrito` varchar(50) DEFAULT NULL,
  `mes` int(11) DEFAULT NULL,
  `estado` int(11) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;


ALTER TABLE `sal_data_pacto1` ADD PRIMARY KEY(`id`);
ALTER TABLE `sal_data_pacto1` CHANGE `id` `id` INT(11) NOT NULL AUTO_INCREMENT;
ALTER TABLE `sal_data_pacto1` ADD INDEX(`importacion_id`);

#
CREATE PROCEDURE bdsismore.sal_pa_procesarPacto1(v_importacion int,v_anio int)
begin

/*
	delete from sal_data_pacto1 where anio=v_anio;
	drop table if exists temp1;
	create temporary table temp1(importacion int, anio int,distrito varchar(50),fechai date,fechaf date,fechae date,estado int);

	insert into temp1
	select imp.id, year(imp.fechaActualizacion),pa.distrito ,pa.fecha_inicial ,pa.fecha_final, pa.fecha_envio ,
		if(pa.fecha_envio between pa.fecha_inicial and date_format(date_add(pa.fecha_inicial,interval 1 month),'%Y-%m-07') ,1,0) as estado
	from sal_impor_padron_actas pa
	left join par_importacion imp on imp.id =pa.importacion_id
	where year(imp.fechaActualizacion)=v_anio and imp.id=v_importacion and year(pa.fecha_final)=year(imp.fechaActualizacion)
	order by pa.distrito,pa.fecha_inicial ;

	insert into sal_data_pacto1(`importacion_id`, `anio`, `distrito`, `mes`, `estado`)
	select importacion, anio, distrito, month(fechai) mes, max(estado) from temp1 group by importacion,anio,distrito,mes;

	update par_importacion set estado="PR" where id=v_importacion;
*/

	delete from sal_data_pacto1 where anio=v_anio;

	drop table if exists temp1;
	drop table if exists temp2;
	create temporary table temp1(importacion int, anio int,distrito varchar(50),fechai date,fechaf date,fechae date,estado int);
	create temporary table temp2(importacion int, anio int,distrito varchar(50),fechai date,fechaf date,fechae date,estado int);

	insert into temp1
	select imp.id, year(imp.fechaActualizacion),pa.distrito ,pa.fecha_inicial ,pa.fecha_final, pa.fecha_envio ,
		if(pa.fecha_envio between pa.fecha_inicial and date_format(date_add(pa.fecha_inicial,interval 1 month),'%Y-%m-07') ,1,0) as estado
	from sal_impor_padron_actas pa
	left join par_importacion imp on imp.id =pa.importacion_id
	where year(imp.fechaActualizacion)=v_anio and imp.id=v_importacion and (year(pa.fecha_inicial)=year(imp.fechaActualizacion) and year(pa.fecha_final)=year(imp.fechaActualizacion))
	order by pa.distrito,pa.fecha_inicial ;

	insert into temp2
	select importacion, anio, distrito , fechai , fechaf, fechae ,
	IF(estado=0,
		IF(month(fechaf)-month(fechai) in(1,2,3) and month(fechaf)=month(fechae),
			IF(fechae between fechaf and date_format(date_add(fechaf,interval 1 month),'%Y-%m-07') ,1,0)
		,0)
	,1)
	 as estado
	from temp1;

	insert into sal_data_pacto1(`importacion_id`, `anio`, `distrito`, `mes`, `estado`)
	select importacion, anio, distrito, month(if(year(fechai)=anio,fechai,if(year(fechaf)=anio,fechaf,fechae))) mes, max(estado) from temp2 group by importacion, anio, distrito, mes;

	update par_importacion set estado="PR" where id=v_importacion;

end

#
ALTER TABLE `par_indicador_general` CHANGE `update_at` `update_at` TIMESTAMP on update CURRENT_TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP;


#

UPDATE `par_ubigeo` SET `nombre` = 'RAIMONDI' WHERE `par_ubigeo`.`id` = 45;

#
ALTER TABLE `sal_impor_padron_actas` ADD FOREIGN KEY (`importacion_id`) REFERENCES `par_importacion`(`id`) ON DELETE RESTRICT ON UPDATE RESTRICT;

#creacion de menu importar padron actas

#

CREATE DEFINER=`root`@`localhost` PROCEDURE `bdsismore`.`sal_pa_procesarPacto1x`(IN `v_importacion` INT, IN `v_anio` INT)
begin
	drop table if exists temp1;
	drop table if exists temp2;
	create temporary table temp1(importacion int, anio int,distrito varchar(50),fechai date,fechaf date,fechae date,estado int);
	create temporary table temp2(importacion int, anio int,distrito varchar(50),fechai date,fechaf date,fechae date,estado int);

	select count(*) 'numero de envios' from sal_impor_padron_actas where importacion_id =v_importacion;
	select distinct year(fecha_inicial),year(fecha_final),year(fecha_envio) 'fechas' from sal_impor_padron_actas where importacion_id =v_importacion;

	insert into temp1
	select imp.id, year(imp.fechaActualizacion),pa.distrito ,pa.fecha_inicial ,pa.fecha_final, pa.fecha_envio ,
		if(pa.fecha_envio between pa.fecha_inicial and date_format(date_add(pa.fecha_inicial,interval 1 month),'%Y-%m-07') ,1,0) as estado
	from sal_impor_padron_actas pa
	left join par_importacion imp on imp.id =pa.importacion_id
	where year(imp.fechaActualizacion)=v_anio and imp.id=v_importacion
	order by pa.distrito,pa.fecha_inicial ;

	select * from temp1;

	insert into temp2
	select importacion, anio, distrito , fechai , fechaf, fechae ,
	IF(estado=0,
		IF(month(fechaf)-month(fechai) in(1,2) and month(fechaf)=month(fechae),
			IF(fechae between fechaf and date_format(date_add(fechaf,interval 1 month),'%Y-%m-07') ,1,0)
		,0)
	,1)
	 as estado
	from temp1;

	select * from temp2;

end

#############
# EDUCACION #
#############

#
ALTER TABLE `edu_impor_matricula_general`
DROP `di_severo`, DROP `discapacidad_fisica`,
DROP `trastorno_espectro_autista`,
DROP `dv_baja_vision`,
DROP `dv_ceguera`,
DROP `da_hipoacusia`,
DROP `da_sordera`,
DROP `sordoceguera`,
DROP `otra_discapacidad`;


#
ALTER TABLE `edu_impor_matricula_general`
CHANGE `di_leve` `id_discapacidad` INT(11) NULL DEFAULT NULL,
CHANGE `di_moderada` `discapacidad` VARCHAR(25) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL;

#
ALTER TABLE `edu_impor_matricula_general`
CHANGE `modalidad` `id_mod` INT NULL DEFAULT NULL,
CHANGE `sexo` `id_sexo` INT NULL DEFAULT NULL,
CHANGE `dsc_grado` `grado` VARCHAR(40) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL,
CHANGE `dsc_seccion` `seccion` VARCHAR(40) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL,
CHANGE `sf_promocion_guiada` `sf_recuperacion` VARCHAR(15) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL;

#
ALTER TABLE `edu_impor_matricula_general` CHANGE `id_discapacidad` `id_discapacidad` VARCHAR(5) NULL DEFAULT NULL;


#
ALTER TABLE `edu_matricula_general_detalle` DROP `di_severo`, DROP `discapacidad_fisica`, DROP `trastorno_espectro_autista`, DROP `dv_baja_vision`, DROP `dv_ceguera`, DROP `da_hipoacusia`, DROP `da_sordera`, DROP `sordoceguera`, DROP `otra_discapacidad`;

#
CREATE DEFINER=root@localhost PROCEDURE bdsismore.edu_pa_procesarImporMatriculaGeneral(v_importacion_id INT, v_matricula_id INT,v_fecha_actualizacion varchar(10))
begin

	DROP TABLE IF EXISTS tmp1;
	CREATE TEMPORARY TABLE tmp1 (id int(11) NOT NULL AUTO_INCREMENT PRIMARY KEY,codigo varchar(10) DEFAULT NULL,nombre varchar(100) DEFAULT NULL);

	UPDATE edu_impor_matricula_general SET
		id_anio=ltrim(rtrim(ifnull(id_anio,''))),
		cod_mod=ltrim(rtrim(ifnull(cod_mod,''))),
		id_mod=ltrim(rtrim(ifnull(id_mod,''))),
		id_nivel=ltrim(rtrim(ifnull(id_nivel,''))),
		id_gestion=ltrim(rtrim(ifnull(id_gestion,''))),
		id_sexo=ltrim(rtrim(ifnull(id_sexo,''))),
		fecha_nacimiento=ltrim(rtrim(ifnull(fecha_nacimiento,''))),
		pais_nacimiento=ltrim(rtrim(ifnull(pais_nacimiento,''))),
		lengua_materna=ltrim(rtrim(ifnull(lengua_materna,''))),
		segunda_lengua=ltrim(rtrim(ifnull(segunda_lengua,''))),
		id_discapacidad=ltrim(rtrim(ifnull(id_discapacidad,''))),
		discapacidad=ltrim(rtrim(ifnull(discapacidad,''))),
		situacion_matricula=ltrim(rtrim(ifnull(situacion_matricula,''))),
		estado_matricula=ltrim(rtrim(ifnull(estado_matricula,''))),
		fecha_matricula=ltrim(rtrim(ifnull(fecha_matricula,''))),
		id_grado=ltrim(rtrim(ifnull(id_grado,''))),
		grado=ltrim(rtrim(ifnull(grado,''))),
		id_seccion=ltrim(rtrim(ifnull(id_seccion,''))),
		seccion=ltrim(rtrim(ifnull(seccion,''))),
		fecha_registro=ltrim(rtrim(ifnull(fecha_registro,''))),
		fecha_retiro=if(fecha_retiro='NULL','',ltrim(rtrim(ifnull(fecha_retiro,'')))),
		motivo_retiro=ltrim(rtrim(ifnull(motivo_retiro,''))),
		sf_regular=ltrim(rtrim(ifnull(sf_regular,''))),
		sf_recuperacion=ltrim(rtrim(ifnull(sf_recuperacion,'')))
	WHERE importacion_id=v_importacion_id;


	insert into tmp1 (codigo) select codigo from edu_discapacidad;
	insert into edu_discapacidad(codigo,nombre,estado)
    select distinct id_discapacidad,discapacidad,"AC" from edu_impor_matricula_general where discapacidad!="" and id_discapacidad not in (select codigo from tmp1) order by discapacidad;
	/*truncate tmp1;*/


	drop table tmp1;

    begin

		INSERT INTO edu_matricula_general_detalle(
		matriculageneral_id, 	institucioneducativa_id, 	cod_mod, 			modalidad_id, 			nivel_codigo,
		gestion_id, 			pais_nacimiento, 			fecha_nacimiento, 	edad, 					sexo_id,
		lengua_materna, 		segunda_lengua, 			discapacidad_id, 	situacion_matricula, 	estado_matricula,
		fecha_matricula, 		grado_id, 					grado, 				seccion_id, 			seccion,
		fecha_registro, 		fecha_retiro, 				motivo_retiro, 		sf_regular, 			sf_recuperacion
		)
		SELECT
			v_matricula_id,
			(select id from edu_institucioneducativa  where codModular=imp.cod_mod) as iiee,
			/*imp.id_anio,*/
			imp.cod_mod,
			imp.id_mod,
			imp.id_nivel,

			imp.id_gestion,
			imp.pais_nacimiento,
			/*imp.fecha_nacimiento, */
			if(imp.fecha_nacimiento='NULL' or imp.fecha_nacimiento='',null,str_to_date(imp.fecha_nacimiento,'%Y-%m-%d')) as fecha_nacimiento,
			if(imp.fecha_nacimiento='NULL' or imp.fecha_nacimiento='',null,
	            YEAR(v_fecha_actualizacion)-YEAR(str_to_date(imp.fecha_nacimiento,'%Y-%m-%d')) +
	            IF(DATE_FORMAT(v_fecha_actualizacion,'%m-%d') > DATE_FORMAT(str_to_date(imp.fecha_nacimiento,'%Y-%m-%d'),'%m-%d'), 0 , -1 )
			) as edad,
			imp.id_sexo,

			imp.lengua_materna,
			imp.segunda_lengua,
			if(imp.id_discapacidad="NULL" or imp.id_discapacidad="",null,(select id from edu_discapacidad where codigo=imp.id_discapacidad)) as discapacidad,
			imp.situacion_matricula,
			imp.estado_matricula,

			if(imp.fecha_matricula='NULL' or imp.fecha_matricula='',null,str_to_date(imp.fecha_matricula,'%Y-%m-%d')) as fecha_matricula,
			/*imp.fecha_matricula, */
			imp.id_grado,
			imp.grado,
			imp.id_seccion,
			imp.seccion,

			if(imp.fecha_registro='NULL' or imp.fecha_registro='',null,str_to_date(imp.fecha_registro,'%Y-%m-%d')) as fecha_registro,
			if(imp.fecha_retiro='NULL' or imp.fecha_retiro='',null,str_to_date(imp.fecha_retiro,'%Y-%m-%d')) as fecha_retiro,
			/*imp.fecha_registro, */
			/*imp.fecha_retiro, */
			imp.motivo_retiro,
			imp.sf_regular,
			imp.sf_recuperacion
		FROM edu_impor_matricula_general as imp WHERE imp.importacion_id=v_importacion_id;

		update par_importacion  set estado = 'PR' where id = v_importacion_id;

		/*truncate edu_impor_matricula_general;*/


    END;

   	/*truncate tmp1;*/
	/*delete from tmp1;*/
	/*drop table tmp1;*/
END

#
ALTER TABLE `edu_matricula_general_detalle` CHANGE `modalidad` `modalidad_id` INT(1) NULL DEFAULT NULL;

#
ALTER TABLE `edu_matricula_general_detalle` CHANGE `dsc_grado` `grado` VARCHAR(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL, CHANGE `dsc_seccion` `seccion` VARCHAR(100) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL, CHANGE `sf_promocion_guiada` `sf_recuperacion` VARCHAR(40) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL;

#
ALTER TABLE `edu_matricula_general_detalle` CHANGE `nivel` `nivel_codigo` INT(11) NULL DEFAULT NULL, CHANGE `gestion` `gestion_id` INT(11) NULL DEFAULT NULL, CHANGE `sexo` `sexo_id` INT(11) NULL DEFAULT NULL;

#
ALTER TABLE `edu_matricula_general_detalle` ADD `discapacidad_id` INT NULL DEFAULT NULL AFTER `segunda_lengua`;

#
ALTER TABLE `edu_matricula_general_detalle` CHANGE `id_grado` `grado_id` INT(11) NULL DEFAULT NULL, CHANGE `id_seccion` `seccion_id` INT(11) NULL DEFAULT NULL;

#
ALTER TABLE `edu_matricula_general_detalle` CHANGE `nivel_codigo` `nivel_codigo` VARCHAR(3) NULL DEFAULT NULL;













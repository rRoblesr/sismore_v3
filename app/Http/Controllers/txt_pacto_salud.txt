##################################################################################################
pacto 3 con metas porcentuales

INSERT INTO `par_indicador_general_meta` (`indicadorgeneral`, `distrito`, `anio_base`, `valor_base`, `anio`, `valor`) VALUES
(19,36,2022,0,2023,55),
(19,37,2022,0,2023,55),
(19,38,2022,0,2023,56),
(19,39,2022,0,2023,50),
(19,40,2022,0,2023,55),
(19,41,2022,0,2023,45),
(19,42,2022,0,2023,35),
(19,44,2022,0,2023,25),
(19,45,2022,0,2023,48),
(19,46,2022,0,2023,50),
(19,47,2022,0,2023,45),
(19,49,2022,0,2023,53),
(19,50,2022,0,2023,45),
(19,51,2022,0,2023,55),
(19,52,2022,0,2023,55),
(19,53,2022,0,2023,50),
(19,56,2022,0,2023,45),
(19,57,2022,0,2023,45),
(19,55,2022,0,2023,55),
(19,36,2022,0,2024,65),
(19,37,2022,0,2024,65),
(19,38,2022,0,2024,65),
(19,39,2022,0,2024,62),
(19,40,2022,0,2024,70),
(19,41,2022,0,2024,65),
(19,42,2022,0,2024,50),
(19,44,2022,0,2024,55),
(19,45,2022,0,2024,63),
(19,46,2022,0,2024,68),
(19,47,2022,0,2024,60),
(19,49,2022,0,2024,66),
(19,50,2022,0,2024,65),
(19,51,2022,0,2024,65),
(19,52,2022,0,2024,75),
(19,53,2022,0,2024,62),
(19,56,2022,0,2024,55),
(19,57,2022,0,2024,65),
(19,55,2022,0,2024,60);

##################################################################################################
pacto 3 con metas numericas

INSERT INTO `par_indicador_general_meta` (`indicadorgeneral`, `distrito`, `anio_base`, `valor_base`, `anio`, `valor`) VALUES
(19,36,2022,0,2023,365),
(19,37,2022,0,2023,580),
(19,38,2022,0,2023,310),
(19,39,2022,0,2023,50),
(19,40,2022,0,2023,35),
(19,41,2022,0,2023,25),
(19,42,2022,0,2023,50),
(19,44,2022,0,2023,17),
(19,45,2022,0,2023,389),
(19,46,2022,0,2023,53),
(19,47,2022,0,2023,32),
(19,49,2022,0,2023,119),
(19,50,2022,0,2023,41),
(19,51,2022,0,2023,46),
(19,52,2022,0,2023,25),
(19,53,2022,0,2023,31),
(19,56,2022,0,2023,5),
(19,57,2022,0,2023,25),
(19,55,2022,0,2023,15),
(19,36,2022,0,2024,460),
(19,37,2022,0,2024,594),
(19,38,2022,0,2024,497),
(19,39,2022,0,2024,37),
(19,40,2022,0,2024,110),
(19,41,2022,0,2024,110),
(19,42,2022,0,2024,98),
(19,44,2022,0,2024,15),
(19,45,2022,0,2024,287),
(19,46,2022,0,2024,37),
(19,47,2022,0,2024,50),
(19,49,2022,0,2024,203),
(19,50,2022,0,2024,92),
(19,51,2022,0,2024,80),
(19,52,2022,0,2024,57),
(19,53,2022,0,2024,34),
(19,56,2022,0,2024,10),
(19,57,2022,0,2024,17),
(19,55,2022,0,2024,27);

##################################################################################################
pacto 4 con metas numericas

INSERT INTO `par_indicador_general_meta` (`indicadorgeneral`, `distrito`, `anio_base`, `valor_base`, `anio`, `valor`) VALUES
(20,36,2022,0,2023,0),
(20,37,2022,0,2023,0),
(20,38,2022,0,2023,0),
(20,39,2022,0,2023,0),
(20,40,2022,0,2023,0),
(20,41,2022,0,2023,0),
(20,42,2022,0,2023,0),
(20,44,2022,0,2023,0),
(20,45,2022,0,2023,0),
(20,46,2022,0,2023,0),
(20,47,2022,0,2023,0),
(20,49,2022,0,2023,0),
(20,50,2022,0,2023,0),
(20,51,2022,0,2023,0),
(20,52,2022,0,2023,0),
(20,53,2022,0,2023,0),
(20,56,2022,0,2023,0),
(20,57,2022,0,2023,0),
(20,55,2022,0,2023,0),
(20,36,2022,0,2024,3),
(20,37,2022,0,2024,4),
(20,38,2022,0,2024,1),
(20,39,2022,0,2024,5),
(20,40,2022,0,2024,3),
(20,41,2022,0,2024,3),
(20,42,2022,0,2024,15),
(20,44,2022,0,2024,0),
(20,45,2022,0,2024,4),
(20,46,2022,0,2024,1),
(20,47,2022,0,2024,1),
(20,49,2022,0,2024,2),
(20,50,2022,0,2024,4),
(20,51,2022,0,2024,2),
(20,52,2022,0,2024,3),
(20,53,2022,0,2024,2),
(20,56,2022,0,2024,2),
(20,57,2022,0,2024,2),
(20,55,2022,0,2024,0);

##################################################################################################
pacto 5 con metas numericas

INSERT INTO `par_indicador_general_meta` (`indicadorgeneral`, `distrito`, `anio_base`, `valor_base`, `anio`, `valor`) VALUES
(21,36,2022,0,2023,1),
(21,37,2022,0,2023,1),
(21,38,2022,0,2023,1),
(21,39,2022,0,2023,1),
(21,40,2022,0,2023,1),
(21,41,2022,0,2023,1),
(21,42,2022,0,2023,1),
(21,44,2022,0,2023,1),
(21,45,2022,0,2023,1),
(21,46,2022,0,2023,1),
(21,47,2022,0,2023,1),
(21,49,2022,0,2023,1),
(21,50,2022,0,2023,1),
(21,51,2022,0,2023,1),
(21,52,2022,0,2023,1),
(21,53,2022,0,2023,1),
(21,56,2022,0,2023,1),
(21,57,2022,0,2023,1),
(21,55,2022,0,2023,1),
(21,36,2022,0,2024,1),
(21,37,2022,0,2024,1),
(21,38,2022,0,2024,1),
(21,39,2022,0,2024,1),
(21,40,2022,0,2024,1),
(21,41,2022,0,2024,1),
(21,42,2022,0,2024,1),
(21,44,2022,0,2024,1),
(21,45,2022,0,2024,1),
(21,46,2022,0,2024,1),
(21,47,2022,0,2024,1),
(21,49,2022,0,2024,1),
(21,50,2022,0,2024,1),
(21,51,2022,0,2024,1),
(21,52,2022,0,2024,1),
(21,53,2022,0,2024,1),
(21,56,2022,0,2024,1),
(21,57,2022,0,2024,1),
(21,55,2022,0,2024,1);


#######################################################################################################

CREATE TABLE `sal_data_pacto3` (
  `id` int(11) auto_increment primary key,
  `importacion_id` int(11) DEFAULT NULL,
  `cantidad` int(11) DEFAULT NULL,
  `distrito` varchar(50) DEFAULT NULL,
  `mes` int(11) DEFAULT NULL,
  `anio` int(11) DEFAULT NULL,
  foreign key(importacion_id) references par_importacion(id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;


#####################################################################################################

CREATE TABLE `sal_data_pacto3_denominador` (
  `id` int(11) auto_increment primary key,
  `ubigeo_id` int(11) DEFAULT NULL,
  `anio` int(11) DEFAULT NULL,
  `codigo` varchar(6) DEFAULT NULL,  
  `distrito` varchar(50) DEFAULT NULL,
  `meta` int(11) DEFAULT NULL,     
  foreign key(ubigeo_id) references par_ubigeo(id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

#####################################################################################################



SELECT cpn.distrito,sum(cpn.cantidad) niños_clorados,cpd.cantidad niños_vivientes,round(100*sum(cpn.cantidad)/cpd.cantidad,2) FROM(
    SELECT ubigeo_ccpp,nombre_ccpp FROM pvica
    where cloro_parametros_decreto>=0.5
    group by ubigeo_ccpp,nombre_ccpp order by ubigeo_ccpp
) as cp
inner join centropoblado_ninios cpn on cpn.ubigeo=cp.ubigeo_ccpp 
inner join (select distrito ,sum(cantidad) cantidad from centropoblado_ninios group by distrito) cpd on cpd.distrito=cpn.distrito
group by cpn.distrito,cpd.distrito;

select distrito ,sum(cantidad) from centropoblado_ninios group by distrito;

SELECT ubigeo_ccpp,nombre_ccpp FROM pvica
-- where cloro_parametros_decreto>=0.5
group by ubigeo_ccpp,nombre_ccpp order by ubigeo_ccpp;

############################################################################













